
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/agent-lightning/latest/reference/trainer/">
      
      
        <link rel="prev" href="../store/">
      
      
        <link rel="next" href="../types/">
      
      
      <link rel="icon" href="../../assets/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Trainer - Agent-lightning</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="agl" data-md-color-accent="agl">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#agent-lightning-trainer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Agent-lightning" class="md-header__button md-logo" aria-label="Agent-lightning" data-md-component="logo">
      
  <img src="../../assets/favicon-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Agent-lightning
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Trainer
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="agl" data-md-color-accent="agl"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="agl" data-md-color-accent="agl"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/agent-lightning" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    agent-lightning
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Agent-lightning" class="md-nav__button md-logo" aria-label="Agent-lightning" data-md-component="logo">
      
  <img src="../../assets/favicon-white.svg" alt="logo">

    </a>
    Agent-lightning
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/agent-lightning" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    agent-lightning
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Quickstart
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/train-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Train the First Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/write-first-algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Write the First Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    How-To Recipes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-To Recipes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/unsloth-sft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SFT with Unsloth
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/train-sql-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Train SQL Agent with RL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Learning More
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Learning More
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/write-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Write Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/debug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/traces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Traces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/parallelize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parallelize
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Algorithm Zoo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Algorithm Zoo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithm-zoo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithm-zoo/apo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    APO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithm-zoo/verl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VERL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Deep Dive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Deep Dive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-dive/birds-eye-view/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bird's Eye View
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-dive/store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding Store
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-dive/serving-llm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serving LLM
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API References
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            API References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command Line
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../instrumentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instrumentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Store
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Trainer
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Trainer
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#agentlightning.Trainer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.adapter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;adapter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.daemon" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;daemon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.hooks" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.initial_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;initial_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.llm_proxy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;llm_proxy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.max_rollouts" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_rollouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.max_tasks" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.n_runners" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_runners
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.n_workers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_workers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.port" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.runner" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;runner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.store" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;store
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.strategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.tracer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tracer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.triplet_exporter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;triplet_exporter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.dev" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;dev
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.fit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.build_component" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;build_component
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Execution Strategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Execution Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.ExecutionStrategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExecutionStrategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ExecutionStrategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.ExecutionStrategy.execute" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.ClientServerExecutionStrategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClientServerExecutionStrategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ClientServerExecutionStrategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.ClientServerExecutionStrategy.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.SharedMemoryExecutionStrategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SharedMemoryExecutionStrategy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    <span class="md-ellipsis">
      Events
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.ExecutionEvent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExecutionEvent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.ThreadingEvent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ThreadingEvent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.MultiprocessingEvent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MultiprocessingEvent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli-builder" class="md-nav__link">
    <span class="md-ellipsis">
      CLI Builder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLI Builder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.lightning_cli" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lightning_cli
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../internal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#agentlightning.Trainer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.adapter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;adapter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.daemon" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;daemon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.hooks" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.initial_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;initial_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.llm_proxy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;llm_proxy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.max_rollouts" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_rollouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.max_tasks" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.n_runners" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_runners
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.n_workers" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_workers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.port" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.runner" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;runner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.store" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;store
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.strategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.tracer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tracer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.triplet_exporter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;triplet_exporter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.dev" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;dev
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Trainer.fit" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.build_component" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;build_component
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Execution Strategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Execution Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.ExecutionStrategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExecutionStrategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ExecutionStrategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.ExecutionStrategy.execute" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.ClientServerExecutionStrategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClientServerExecutionStrategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ClientServerExecutionStrategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.ClientServerExecutionStrategy.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.SharedMemoryExecutionStrategy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SharedMemoryExecutionStrategy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    <span class="md-ellipsis">
      Events
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.ExecutionEvent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ExecutionEvent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.ThreadingEvent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ThreadingEvent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.MultiprocessingEvent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MultiprocessingEvent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli-builder" class="md-nav__link">
    <span class="md-ellipsis">
      CLI Builder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLI Builder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.lightning_cli" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lightning_cli
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <div id="version-warning" class="version-warning" style="display: none;">
    ⚠️ You are viewing development documentation. For stable documentation, please visit
    <a href="https://microsoft.github.io/agent-lightning/stable/">https://microsoft.github.io/agent-lightning/stable/</a>
  </div>
  
                  <!-- Copied and modified from https://github.com/squidfunk/mkdocs-material/blob/master/src/templates/partials/content.html -->

<!-- Tags -->



<!-- Actions -->

  
  


<!--
  Hack: check whether the content contains a h1 headline. If it doesn't, the
  page title (or respectively site name) is used as the main headline.
-->


<!-- Source file information -->







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 15, 2025 05:37:44 UTC"><span class="timeago" datetime="2025-10-15T05:37:44+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 15, 2025 05:37:44 UTC">2025-10-15</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 15, 2025 05:37:44 UTC"><span class="timeago" datetime="2025-10-15T05:37:44+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 15, 2025 05:37:44 UTC">2025-10-15</span>
  </span>

    
    
      
  
  <span class="md-source-file__fact">
    <span class="md-icon" title="Contributors">
      
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"/></svg>
      
    </span>
    <nav>
      
        <a href="mailto:yuge.zhang@microsoft.com">Yuge Zhang</a>
    </nav>
  </span>

    
    
  </aside>


<!-- Page content -->
<h1 id="agent-lightning-trainer">Agent-lightning Trainer<a class="headerlink" href="#agent-lightning-trainer" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-class">



<h3 id="agentlightning.Trainer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.Trainer</code>


<a href="#agentlightning.Trainer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="agentlightning.trainer.legacy.TrainerLegacy">TrainerLegacy</span></code></p>


        <p>High-level orchestration layer that wires Algorithm &lt;-&gt; Runner &lt;-&gt; Store.</p>
<p>A <a class="autorefs autorefs-internal" title="            agentlightning.Trainer" href="#agentlightning.Trainer"><code>Trainer</code></a> packages the moving parts of Agent-Lightning's
training loop into a single entry point:</p>
<ul>
<li><strong>Algorithm lifecycle:</strong> Instantiates or accepts an <a class="autorefs autorefs-internal" title="            agentlightning.Algorithm" href="../algorithm/#agentlightning.Algorithm"><code>Algorithm</code></a>,
  attaches the current <a class="autorefs autorefs-internal" title="            agentlightning.LightningStore" href="../store/#agentlightning.LightningStore"><code>LightningStore</code></a>, adapter, and
  initial resources, then executes the algorithm role inside the configured execution strategy.</li>
<li><strong>Runner fleet:</strong> Spawns one or more <a class="autorefs autorefs-internal" title="            agentlightning.Runner" href="../runner/#agentlightning.Runner"><code>Runner</code></a> instances (defaulting
  to <a class="autorefs autorefs-internal" title="            agentlightning.LitAgentRunner" href="../runner/#agentlightning.LitAgentRunner"><code>LitAgentRunner</code></a>) that hydrate a <a class="autorefs autorefs-internal" title="            agentlightning.LitAgent" href="../agent/#agentlightning.LitAgent"><code>LitAgent</code></a>,
  claim rollouts, stream spans, and respect graceful termination signals from the execution strategy.</li>
<li><strong>Execution strategy:</strong> Delegates process management to an
  <a class="autorefs autorefs-internal" title="            agentlightning.ExecutionStrategy" href="#agentlightning.ExecutionStrategy"><code>ExecutionStrategy</code></a> (shared memory, client/server, etc.),
  so advanced users can swap orchestration backends without changing trainer code.</li>
<li><strong>Telemetry plumbing:</strong> Ensures tracers, adapters, and optional <a class="autorefs autorefs-internal" title="            agentlightning.LLMProxy" href="../algorithm/#agentlightning.LLMProxy"><code>LLMProxy</code></a>
  are wired into both algorithm and runners so telemetry flows back into the store.</li>
</ul>
<p>The trainer exposes two convenience entry points:
<a class="autorefs autorefs-internal" title="            fit(agent, train_dataset=None, *, val_dataset=None)" href="#agentlightning.Trainer.fit"><code>fit()</code></a> for full training and
<a class="autorefs autorefs-internal" title="            dev(agent, train_dataset=None, *, val_dataset=None)" href="#agentlightning.Trainer.dev"><code>dev()</code></a> for fast, reproducible dry-runs. See the
<a href="../../how-to/train-first-agent/">Train the First Agent</a> and
<a href="../../how-to/write-first-algorithm/">Write the First Algorithm</a> tutorials for the broader context.</p>











  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.adapter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">adapter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_adapter</span><span class="p">(</span><span class="n">adapter_spec</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.adapter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>An instance of <a class="autorefs autorefs-internal" title="            agentlightning.TraceAdapter" href="../algorithm/#agentlightning.TraceAdapter"><code>TraceAdapter</code></a> to export data consumble by algorithms from traces.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.algorithm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">algorithm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_algorithm</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.algorithm" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>An instance of <a class="autorefs autorefs-internal" title="            agentlightning.Algorithm" href="../algorithm/#agentlightning.Algorithm"><code>Algorithm</code></a> to use for training.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.daemon" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">daemon</span> <span class="o">=</span> <span class="n">daemon</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.daemon" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Whether worker processes should be daemons. Daemon processes
are terminated automatically when the main process exits. Deprecated.
Only have effect with <code>fit_v0</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.hooks" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_hooks</span><span class="p">(</span><span class="n">hooks</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.hooks" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>A sequence of <a class="autorefs autorefs-internal" title="            agentlightning.Hook" href="../types/#agentlightning.Hook"><code>Hook</code></a> instances to be called at various lifecycle stages (e.g., <code>on_trace_start</code>,
<code>on_trace_end</code>, <code>on_rollout_start</code>, <code>on_rollout_end</code>).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.initial_resources" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">initial_resources</span> <span class="o">=</span> <span class="n">initial_resources</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.initial_resources" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>An instance of <a class="autorefs autorefs-internal" title="            agentlightning.NamedResources = Dict[str, ResourceUnion]

  
      module-attribute
  " href="../types/#agentlightning.NamedResources"><code>NamedResources</code></a> to use for bootstrapping the fit/dev process.</p>
<p>The resources will be handed over to the algorithm. Note that not all algorithms support seeding resources.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.llm_proxy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">llm_proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_llm_proxy</span><span class="p">(</span><span class="n">llm_proxy</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.llm_proxy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>An instance of <a class="autorefs autorefs-internal" title="            agentlightning.LLMProxy" href="../algorithm/#agentlightning.LLMProxy"><code>LLMProxy</code></a> to use for intercepting the LLM calls.
If not provided, algorithm may create one on its own.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.max_rollouts" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">max_rollouts</span> <span class="o">=</span> <span class="n">max_rollouts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.max_rollouts" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Maximum number of rollouts to process per runner. If None, workers run until no more rollouts are available.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.max_tasks" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">max_tasks</span> <span class="o">=</span> <span class="n">max_tasks</span> <span class="k">if</span> <span class="n">max_tasks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">max_rollouts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.max_tasks" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Maximum number of tasks to process per runner. Deprecated in favor of <code>max_rollouts</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.n_runners" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">n_runners</span> <span class="o">=</span> <span class="n">n_runners</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.n_runners" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Number of agent runners to run in parallel.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.n_workers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">n_workers</span> <span class="o">=</span> <span class="n">n_runners</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.n_workers" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Number of agent workers to run in parallel. Deprecated in favor of <code>n_runners</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.port" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">port</span> <span class="o">=</span> <span class="n">port</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.port" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Port forwarded to <a class="autorefs autorefs-internal" title="            agentlightning.ClientServerExecutionStrategy" href="#agentlightning.ClientServerExecutionStrategy"><code>ClientServerExecutionStrategy</code></a>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.runner" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">runner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_runner</span><span class="p">(</span><span class="n">runner</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.runner" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>An instance of <a class="autorefs autorefs-internal" title="            agentlightning.Runner" href="../runner/#agentlightning.Runner"><code>Runner</code></a> to use for running the agent.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.store" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">store</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_store</span><span class="p">(</span><span class="n">store</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.store" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>An instance of <a class="autorefs autorefs-internal" title="            agentlightning.LightningStore" href="../store/#agentlightning.LightningStore"><code>LightningStore</code></a> to use for storing tasks and traces.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.strategy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_strategy</span><span class="p">(</span><span class="n">strategy</span><span class="p">,</span> <span class="n">n_runners</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_runners</span><span class="p">),</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>An instance of <a class="autorefs autorefs-internal" title="            agentlightning.ExecutionStrategy" href="#agentlightning.ExecutionStrategy"><code>ExecutionStrategy</code></a> to use for spawning the algorithm and runners.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.tracer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">tracer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_tracer</span><span class="p">(</span><span class="n">tracer</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.tracer" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>A tracer instance, or a string pointing to the class full name or a dictionary with a 'type' key
that specifies the class full name and other initialization parameters.
If None, a default <a class="autorefs autorefs-internal" title="            agentlightning.AgentOpsTracer" href="../runner/#agentlightning.AgentOpsTracer"><code>AgentOpsTracer</code></a> will be created with the current settings.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.Trainer.triplet_exporter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">triplet_exporter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adapter</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.Trainer.triplet_exporter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>An instance of <a class="autorefs autorefs-internal" title="            agentlightning.TracerTraceToTriplet" href="../algorithm/#agentlightning.TracerTraceToTriplet"><code>TracerTraceToTriplet</code></a> to export triplets from traces,
or a dictionary with the initialization parameters for the exporter.
Deprecated. Use <a class="autorefs autorefs-internal" title="            adapter = self._make_adapter(adapter_spec)

  
      instance-attribute
  " href="#agentlightning.Trainer.adapter"><code>adapter</code></a> instead.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="agentlightning.Trainer.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">dev</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_runners</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_rollouts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_resources</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tracer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adapter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">llm_proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_tasks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">triplet_exporter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.Trainer.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Configure the trainer and resolve user-provided component specifications.</p>
<p>Each keyword accepts either a concrete instance, a class, a callable factory, a
registry string, or a lightweight configuration dictionary (see
<a class="autorefs autorefs-internal" title="            agentlightning.build_component(spec, *, expected_type, spec_name, default_factory=None, allow_none=False, optional_defaults=None, dict_requires_type=True, dict_default_cls=None, type_error_fmt=None, invalid_spec_error_fmt=None, registry=None)" href="#agentlightning.build_component"><code>build_component()</code></a>).</p>
<p>When <code>port</code> is provided it is forwarded to
<a class="autorefs autorefs-internal" title="            agentlightning.ClientServerExecutionStrategy" href="#agentlightning.ClientServerExecutionStrategy"><code>ClientServerExecutionStrategy</code></a>
instances constructed (or supplied) for the trainer.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.Trainer.dev" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">dev</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">train_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">val_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.Trainer.dev" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Exercise the infrastructure using a fast, synchronous algorithm.</p>
<p><a class="autorefs autorefs-internal" title="            dev(agent, train_dataset=None, *, val_dataset=None)" href="#agentlightning.Trainer.dev"><code>Trainer.dev</code></a> mirrors <a class="autorefs autorefs-internal" title="            fit(agent, train_dataset=None, *, val_dataset=None)" href="#agentlightning.Trainer.fit"><code>fit()</code></a> but
insists on an <a class="autorefs autorefs-internal" title="            agentlightning.Algorithm" href="../algorithm/#agentlightning.Algorithm"><code>Algorithm</code></a> subtype that also derives from
<a class="autorefs autorefs-internal" title="            agentlightning.FastAlgorithm" href="../algorithm/#agentlightning.FastAlgorithm"><code>FastAlgorithm</code></a>. This keeps the loop responsive for
debugging while still touching the same store, runners, hooks, and tracer plumbing.</p>
<p>If no algorithm is provided, a default <a class="autorefs autorefs-internal" title="            agentlightning.Baseline" href="../algorithm/#agentlightning.Baseline"><code>Baseline</code></a> algorithm will be used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>agent</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.LitAgent (agentlightning.litagent.LitAgent)" href="../agent/#agentlightning.LitAgent">LitAgent</a>[<span title="agentlightning.trainer.trainer.T_co">T_co</span>]</code>)
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.LitAgent" href="../agent/#agentlightning.LitAgent"><code>LitAgent</code></a> implementation to execute.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>train_dataset</code></b>
              (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Dataset (agentlightning.types.Dataset)" href="../types/#agentlightning.Dataset">Dataset</a>[<span title="agentlightning.trainer.trainer.T_co">T_co</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional iterable passed to the algorithm.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>val_dataset</code></b>
              (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Dataset (agentlightning.types.Dataset)" href="../types/#agentlightning.Dataset">Dataset</a>[<span title="agentlightning.trainer.trainer.T_co">T_co</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional iterable passed to the algorithm.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="TypeError">TypeError</span></code>
            –
          <div class="doc-md-description">
            <p>If the configured algorithm does not inherit from <code>FastAlgorithm</code>.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.Trainer.fit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">train_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">val_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.Trainer.fit" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Execute the full algorithm/runner training loop.</p>
<p><a class="autorefs autorefs-internal" title="            fit(agent, train_dataset=None, *, val_dataset=None)" href="#agentlightning.Trainer.fit"><code>Trainer.fit</code></a> packages the algorithm and runner bundles,
then hands them to the active <a class="autorefs autorefs-internal" title="            agentlightning.ExecutionStrategy" href="#agentlightning.ExecutionStrategy"><code>ExecutionStrategy</code></a>.
The strategy rarely returns until:</p>
<ul>
<li>The algorithm exhausts the dataset(s) and stops enqueuing rollouts.</li>
<li><code>max_rollouts</code> causes individual runners to exit.</li>
<li>An exception or interrupt cancels the shared <a class="autorefs autorefs-internal" title="            agentlightning.ExecutionEvent" href="#agentlightning.ExecutionEvent"><code>ExecutionEvent</code></a>.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>agent</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.LitAgent (agentlightning.litagent.LitAgent)" href="../agent/#agentlightning.LitAgent">LitAgent</a>[<span title="agentlightning.trainer.trainer.T_co">T_co</span>]</code>)
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.LitAgent" href="../agent/#agentlightning.LitAgent"><code>LitAgent</code></a> implementation executed by runners.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>train_dataset</code></b>
              (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Dataset (agentlightning.types.Dataset)" href="../types/#agentlightning.Dataset">Dataset</a>[<span title="agentlightning.trainer.trainer.T_co">T_co</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional iterable of rollout inputs consumed by the algorithm.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>val_dataset</code></b>
              (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Dataset (agentlightning.types.Dataset)" href="../types/#agentlightning.Dataset">Dataset</a>[<span title="agentlightning.trainer.trainer.T_co">T_co</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional iterable consumed by validation passes.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agentlightning.build_component" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">agentlightning</span><span class="o">.</span><span class="n">build_component</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">expected_type</span><span class="p">,</span> <span class="n">spec_name</span><span class="p">,</span> <span class="n">default_factory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">optional_defaults</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dict_requires_type</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dict_default_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_error_fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">invalid_spec_error_fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">registry</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.build_component" class="headerlink" title="Permanent link">&para;</a></h3>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">build_component</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">spec</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="n">T</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="p">],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">expected_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">spec_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">default_factory</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">allow_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">optional_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">OptionalDefaults</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">dict_requires_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">dict_default_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">type_error_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">invalid_spec_error_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">registry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">build_component</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">spec</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="n">T</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="p">],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">expected_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">spec_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">default_factory</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">allow_none</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">optional_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">OptionalDefaults</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">dict_requires_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">dict_default_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">type_error_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">invalid_spec_error_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">registry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">build_component</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">spec</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="n">T</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="p">],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">expected_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">spec_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">default_factory</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">allow_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">optional_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">OptionalDefaults</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">dict_requires_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">dict_default_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">type_error_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">invalid_spec_error_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">registry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>          </div>


    <div class="doc doc-contents first">

        <p>Build and return a component instance from a flexible specification.</p>
<p>This function provides a flexible way to create component instances from various
input formats including direct instances, class types, factory functions, import
paths, or configuration dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>spec</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="agentlightning.trainer.init_utils.T">T</span>, <span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>], <span title="type">type</span>[<span title="agentlightning.trainer.init_utils.T">T</span>], <span title="typing.Callable">Callable</span>[[], <span title="agentlightning.trainer.init_utils.T">T</span>], None]</code>)
          –
          <div class="doc-md-description">
            <p>The component specification. Can be:
- An instance of expected_type (returned as-is)
- A string import path (e.g., 'module.Class') or registry key
- A dict with 'type' key (import path or registry key) and constructor kwargs
- A class type (will be instantiated)
- A factory function (will be called)
- None (uses default_factory or returns None if allow_none=True)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>expected_type</code></b>
              (<code><span title="type">type</span>[<span title="agentlightning.trainer.init_utils.T">T</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The type that the resulting instance must be or inherit from.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>spec_name</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Descriptive name for the spec, used in error messages.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>default_factory</code></b>
              (<code><span title="typing.Callable">Callable</span>[[], <span title="agentlightning.trainer.init_utils.T">T</span>] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional factory function called when spec is None.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>allow_none</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>If True, allows None to be returned when spec is None and
no default_factory is provided.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>optional_defaults</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="agentlightning.trainer.init_utils.OptionalDefaults">OptionalDefaults</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Dict mapping parameter names to default values or factory
functions that will be injected if the constructor accepts them.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dict_requires_type</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>If True, dict specs must include a 'type' key.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dict_default_cls</code></b>
              (<code><span title="type">type</span>[<span title="agentlightning.trainer.init_utils.T">T</span>] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Default class to use for dict specs without a 'type' key
(only used when dict_requires_type=False).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>type_error_fmt</code></b>
              (<code><span title="str">str</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Custom format string for type validation errors. Should include
{type_name} and {expected_type} placeholders.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>invalid_spec_error_fmt</code></b>
              (<code><span title="str">str</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Custom format string for invalid spec type errors.
Should include {actual_type} and {expected_type} placeholders.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>registry</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional mapping of short names to fully qualified import paths.
When provided, string specs or dict 'type'/'name' entries are first
resolved through this registry before attempting to import.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="agentlightning.trainer.init_utils.T">T</span> | None</code>
          –
          <div class="doc-md-description">
            <p>An instance of expected_type, or None if allow_none=True and spec is None</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="agentlightning.trainer.init_utils.T">T</span> | None</code>
          –
          <div class="doc-md-description">
            <p>without a default_factory.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="TypeError">TypeError</span></code>
            –
          <div class="doc-md-description">
            <p>If the instantiated object is not an instance of expected_type.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If spec is None and neither default_factory nor allow_none is set,
or if spec type is invalid, or if dict spec is invalid.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Direct instance</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">build_component</span><span class="p">(</span><span class="n">AdamW</span><span class="p">(),</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">Optimizer</span><span class="p">,</span> <span class="n">spec_name</span><span class="o">=</span><span class="s1">&#39;optimizer&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># String import path</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">build_component</span><span class="p">(</span><span class="s1">&#39;torch.optim.AdamW&#39;</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">Optimizer</span><span class="p">,</span> <span class="n">spec_name</span><span class="o">=</span><span class="s1">&#39;optimizer&#39;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Dict with type and kwargs</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;torch.optim.AdamW&#39;</span><span class="p">,</span> <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">build_component</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">Optimizer</span><span class="p">,</span> <span class="n">spec_name</span><span class="o">=</span><span class="s1">&#39;optimizer&#39;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Class type</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">build_component</span><span class="p">(</span><span class="n">AdamW</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">Optimizer</span><span class="p">,</span> <span class="n">spec_name</span><span class="o">=</span><span class="s1">&#39;optimizer&#39;</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Factory function</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">build_component</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">AdamW</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">Optimizer</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span>                           <span class="n">spec_name</span><span class="o">=</span><span class="s1">&#39;optimizer&#39;</span><span class="p">)</span>
</code></pre></div>


    </div>

</div><h2 id="execution-strategy">Execution Strategy<a class="headerlink" href="#execution-strategy" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="agentlightning.ExecutionStrategy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.ExecutionStrategy</code>


<a href="#agentlightning.ExecutionStrategy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Coordinate algorithm and runner bundles within a single process abstraction.</p>
<p>Strategies decide how many worker bundles to launch, whether to communicate
through shared memory or an HTTP boundary, and how to react to shutdown
signals. They intentionally avoid inspecting the bundle internals; instead,
each bundle remains responsible for its own scheduling semantics.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implementations must honor the <a class="autorefs autorefs-internal" title="            execute(algorithm, runner, store)" href="#agentlightning.ExecutionStrategy.execute">execute()</a>
contract by propagating <code>KeyboardInterrupt</code> and ensuring resources are
released when an error occurs on either side of the algorithm/runner
pair.</p>
</div>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.ExecutionStrategy.execute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="n">algorithm</span><span class="p">,</span> <span class="n">runner</span><span class="p">,</span> <span class="n">store</span><span class="p">)</span></code>

<a href="#agentlightning.ExecutionStrategy.execute" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Run the provided bundles using the configured orchestration model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>algorithm</code></b>
              (<code><span title="agentlightning.execution.base.AlgorithmBundle">AlgorithmBundle</span></code>)
          –
          <div class="doc-md-description">
            <p>Callable bundle responsible for algorithm execution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>runner</code></b>
              (<code><span title="agentlightning.execution.base.RunnerBundle">RunnerBundle</span></code>)
          –
          <div class="doc-md-description">
            <p>Callable bundle for runner workers.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>store</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.LightningStore (agentlightning.store.base.LightningStore)" href="../store/#agentlightning.LightningStore">LightningStore</a></code>)
          –
          <div class="doc-md-description">
            <p>Concrete <a class="autorefs autorefs-internal" title="            agentlightning.LightningStore" href="../store/#agentlightning.LightningStore"><code>LightningStore</code></a>
shared across bundles.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="NotImplementedError">NotImplementedError</span></code>
            –
          <div class="doc-md-description">
            <p>Subclasses must provide the orchestration
implementation.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.ClientServerExecutionStrategy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.ClientServerExecutionStrategy</code>


<a href="#agentlightning.ClientServerExecutionStrategy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            agentlightning.ExecutionStrategy (agentlightning.execution.base.ExecutionStrategy)" href="#agentlightning.ExecutionStrategy">ExecutionStrategy</a></code></p>


        <p>Run algorithm and runner bundles as separate processes over HTTP.</p>
<p>Execution Roles:</p>
<ul>
<li><code>"algorithm"</code>: Start <a class="autorefs autorefs-internal" title="            agentlightning.LightningStoreServer" href="../store/#agentlightning.LightningStoreServer"><code>LightningStoreServer</code></a>
  in-process and execute the algorithm bundle against it.</li>
<li><code>"runner"</code>: Connect to an existing server with
  <a class="autorefs autorefs-internal" title="            agentlightning.LightningStoreClient" href="../store/#agentlightning.LightningStoreClient"><code>LightningStoreClient</code></a> and run the
  runner bundle locally (spawning multiple processes when requested).</li>
<li><code>"both"</code>: Spawn runner processes first, then execute the algorithm and
  server on the same machine. This mode orchestrates the full loop locally.</li>
</ul>
<p>When <code>role == "both"</code> you may choose which side runs on the main process
via <code>main_process</code>. The runner-on-main option is limited to
<code>n_runners == 1</code> because each additional runner requires its own event
loop and process.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When <code>main_process == "runner"</code> the algorithm and HTTP server execute
in a child process. Store mutations remain isolated inside that process,
so the original store instance passed to
<a class="autorefs autorefs-internal" title="            execute(algorithm, runner, store)" href="#agentlightning.ExecutionStrategy.execute">execute()</a> is not updated.</p>
</div>
<p>Abort Model (four-step escalation):</p>
<ol>
<li>Cooperative stop. Every bundle receives a shared
   <a class="autorefs autorefs-internal" title="            agentlightning.MultiprocessingEvent" href="#agentlightning.MultiprocessingEvent"><code>MultiprocessingEvent</code></a> (<code>stop_evt</code>).
   Any failure flips the event so peers can exit cleanly. Ctrl+C on the main
   process also sets the flag.</li>
<li>KeyboardInterrupt synthesis. Remaining subprocesses receive <code>SIGINT</code> to
   trigger <code>KeyboardInterrupt</code> handlers.</li>
<li>Termination. Stubborn processes are asked to <code>terminate()</code>
   (<code>SIGTERM</code> on POSIX).</li>
<li>Kill. As a last resort <code>kill()</code> is invoked (<code>SIGKILL</code> on POSIX).</li>
</ol>
<p>This mirrors the semantics implemented in
<a class="autorefs autorefs-internal" title="            agentlightning.SharedMemoryExecutionStrategy" href="#agentlightning.SharedMemoryExecutionStrategy"><code>SharedMemoryExecutionStrategy</code></a>
but adapts them to multiple processes and the HTTP client/server boundary.</p>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.ClientServerExecutionStrategy.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">server_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">server_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_runners</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">graceful_timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">terminate_timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">main_process</span><span class="o">=</span><span class="s1">&#39;algorithm&#39;</span><span class="p">,</span> <span class="n">managed_store</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.ClientServerExecutionStrategy.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Configure the strategy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>role</code></b>
              (<code><span title="typing.Literal">Literal</span>[&#39;algorithm&#39;, &#39;runner&#39;, &#39;both&#39;] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Which side(s) to run in this process. When omitted, the
<code>AGL_CURRENT_ROLE</code> environment variable is used.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>server_host</code></b>
              (<code><span title="str">str</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Interface the HTTP server binds to when running the
algorithm bundle locally. Defaults to <code>AGL_SERVER_HOST</code>
or <code>"localhost"</code> if unset.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>server_port</code></b>
              (<code><span title="int">int</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Port for the HTTP server in "algorithm"/"both" modes.
Defaults to <code>AGL_SERVER_PORT</code> or <code>4747</code> if unset.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>n_runners</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Number of runner processes to spawn in "runner"/"both".</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>graceful_timeout</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>5.0</code>
)
          –
          <div class="doc-md-description">
            <p>How long to wait (seconds) after setting the stop
event before escalating to signals.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>terminate_timeout</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>5.0</code>
)
          –
          <div class="doc-md-description">
            <p>How long to wait between escalation steps beyond
the cooperative phase (re-used for SIGINT, terminate, and kill).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>main_process</code></b>
              (<code><span title="typing.Literal">Literal</span>[&#39;algorithm&#39;, &#39;runner&#39;]</code>, default:
                  <code>&#39;algorithm&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Which bundle runs on the main process when
<code>role == "both"</code>. <code>"runner"</code> requires <code>n_runners == 1</code> and is
primarily intended for debugging.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>managed_store</code></b>
              (<code><span title="bool">bool</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>When <code>True</code> (default) the strategy constructs
LightningStore client/server wrappers automatically. When
<code>False</code> the provided <code>store</code> is passed directly to the
bundles, allowing callers to manage store wrappers manually.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.SharedMemoryExecutionStrategy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.SharedMemoryExecutionStrategy</code>


<a href="#agentlightning.SharedMemoryExecutionStrategy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            agentlightning.ExecutionStrategy (agentlightning.execution.base.ExecutionStrategy)" href="#agentlightning.ExecutionStrategy">ExecutionStrategy</a></code></p>


        <p>Execute bundles in a single process with cooperative worker threads.</p>
<p>Stop Model:</p>
<ul>
<li>All bundles share one <a class="autorefs autorefs-internal" title="            agentlightning.ThreadingEvent" href="#agentlightning.ThreadingEvent"><code>ThreadingEvent</code></a>
  named <code>stop_evt</code>.</li>
<li>Only the main thread receives <code>KeyboardInterrupt</code>. When Ctrl+C occurs we
  set <code>stop_evt</code>.</li>
<li>Any exception raised inside a bundle sets <code>stop_evt</code> so other threads can
  unwind cooperatively.</li>
<li>Once the bundle running on the main thread exits successfully the
  treatment depends on <code>main_thread</code>:<ul>
<li><code>"algorithm"</code>: the runners are asked to stop by setting <code>stop_evt</code>.</li>
<li><code>"runner"</code>: the algorithm keeps running until it exits naturally.</li>
</ul>
</li>
<li>Background threads are marked as daemons. We join them briefly and log any
  stragglers before shutting down.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Signals other than <code>SIGINT</code> (such as <code>SIGTERM</code>) are not intercepted;
Python's default behavior for those signals is preserved.</p>
</div>











  <div class="doc doc-children">












  </div>

    </div>

</div><h2 id="events">Events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="agentlightning.ExecutionEvent" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.ExecutionEvent</code>


<a href="#agentlightning.ExecutionEvent" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>


        <p>Protocol capturing the cooperative stop contract shared by strategies.</p>
<p>Implementations mirror the API of <code>threading.Event</code> and
<code>multiprocessing.Event</code> so the rest of the execution layer can remain
agnostic to the underlying concurrency primitive.</p>
<p>Methods:</p>
<div class="highlight"><pre><span></span><code>set: Signal cancellation. The call must be idempotent.
clear: Reset the event to the unsignaled state.
is_set: Return ``True`` when cancellation has been requested.
wait: Block until the event is signaled or an optional timeout elapses.
</code></pre></div>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.ThreadingEvent" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.ThreadingEvent</code>


<a href="#agentlightning.ThreadingEvent" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Thread-safe implementation of <a class="autorefs autorefs-internal" title="            agentlightning.ExecutionEvent" href="#agentlightning.ExecutionEvent"><code>ExecutionEvent</code></a>.</p>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.MultiprocessingEvent" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.MultiprocessingEvent</code>


<a href="#agentlightning.MultiprocessingEvent" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Process-safe implementation of <a class="autorefs autorefs-internal" title="            agentlightning.ExecutionEvent" href="#agentlightning.ExecutionEvent"><code>ExecutionEvent</code></a>.</p>











  <div class="doc doc-children">












  </div>

    </div>

</div><h2 id="cli-builder">CLI Builder<a class="headerlink" href="#cli-builder" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<h3 id="agentlightning.lightning_cli" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">agentlightning</span><span class="o">.</span><span class="n">lightning_cli</span><span class="p">(</span><span class="o">*</span><span class="n">classes</span><span class="p">)</span></code>

<a href="#agentlightning.lightning_cli" class="headerlink" title="Permanent link">&para;</a></h3>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">lightning_cli</span><span class="p">(</span><span class="n">cls1</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C1</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_C1</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">lightning_cli</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">cls1</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C1</span><span class="p">],</span> <span class="n">cls2</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C2</span><span class="p">]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">_C1</span><span class="p">,</span> <span class="n">_C2</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">lightning_cli</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">cls1</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C1</span><span class="p">],</span> <span class="n">cls2</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C2</span><span class="p">],</span> <span class="n">cls3</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C3</span><span class="p">]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">_C1</span><span class="p">,</span> <span class="n">_C2</span><span class="p">,</span> <span class="n">_C3</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">lightning_cli</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">cls1</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C1</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">cls2</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C2</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">cls3</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C3</span><span class="p">],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">cls4</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_C4</span><span class="p">],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">_C1</span><span class="p">,</span> <span class="n">_C2</span><span class="p">,</span> <span class="n">_C3</span><span class="p">,</span> <span class="n">_C4</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">lightning_cli</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="o">*</span><span class="n">classes</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">CliConfigurable</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">CliConfigurable</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</code></pre></div>          </div>


    <div class="doc doc-contents first">

        <p>Parses command-line arguments to configure and instantiate provided CliConfigurable classes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>*classes</code></b>
              (<code><span title="typing.Type">Type</span>[<span title="agentlightning.config.CliConfigurable">CliConfigurable</span>]</code>, default:
                  <code>()</code>
)
          –
          <div class="doc-md-description">
            <p>One or more classes that inherit from CliConfigurable. Each class's
      <strong>init</strong> parameters will be exposed as command-line arguments.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="agentlightning.config.CliConfigurable">CliConfigurable</span> | <span title="typing.Tuple">Tuple</span>[<span title="agentlightning.config.CliConfigurable">CliConfigurable</span>, ...]</code>
          –
          <div class="doc-md-description">
            <p>A tuple of instantiated objects, corresponding to the input classes in order.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<!-- Was this page helpful? -->




<!-- Comment system -->

                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="https://unpkg.com/chart.js@4.5.1/dist/chart.umd.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../javascripts/charts.js"></script>
      
        <script src="../../javascripts/move-source-file.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
    
  <script>
    // Show warning banner if not viewing stable documentation
    document.addEventListener("DOMContentLoaded", function() {
      const currentURL = window.location.href;
      const warningDiv = document.getElementById("version-warning");

      // Check if we're on the stable docs or the redirect page
      if (currentURL.includes('agent-lightning/latest/')) {
        // Show warning for explicitly latest docs
        warningDiv.style.display = "block";
      }
    });
  </script>

  </body>
</html>