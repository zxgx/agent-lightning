
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/agent-lightning/latest/reference/internal/">
      
      
        <link rel="prev" href="../types/">
      
      
      
      <link rel="icon" href="../../assets/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Internal - Agent-lightning</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="agl" data-md-color-accent="agl">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#internal-api-references" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Agent-lightning" class="md-header__button md-logo" aria-label="Agent-lightning" data-md-component="logo">
      
  <img src="../../assets/favicon-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Agent-lightning
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Internal
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="agl" data-md-color-accent="agl"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="agl" data-md-color-accent="agl"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/agent-lightning" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    agent-lightning
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Agent-lightning" class="md-nav__button md-logo" aria-label="Agent-lightning" data-md-component="logo">
      
  <img src="../../assets/favicon-white.svg" alt="logo">

    </a>
    Agent-lightning
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/agent-lightning" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    agent-lightning
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Quickstart
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/train-first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Train the First Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/write-first-algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Write the First Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    How-To Recipes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-To Recipes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/unsloth-sft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SFT with Unsloth
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/train-sql-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Train SQL Agent with RL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Learning More
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Learning More
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/write-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Write Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/debug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/traces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Traces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/parallelize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parallelize
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Algorithm Zoo
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Algorithm Zoo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithm-zoo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithm-zoo/apo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    APO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithm-zoo/verl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VERL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Deep Dive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Deep Dive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-dive/birds-eye-view/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bird's Eye View
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-dive/store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding Store
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-dive/serving-llm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serving LLM
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API References
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            API References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command Line
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../instrumentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instrumentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Store
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trainer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Internal
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Internal
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#agentlightning.adapter.messages.OpenAIMessages" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;OpenAIMessages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TraceTree
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TraceTree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.agent_name" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;agent_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.find_llm_calls" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;find_llm_calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.from_spans" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_spans
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.is_reward_span" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_reward_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.match_rewards" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;match_rewards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.maybe_reward_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;maybe_reward_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.names_tuple" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;names_tuple
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.repair_hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;repair_hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.span_to_triplet" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;span_to_triplet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.to_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_trajectory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.traverse" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;traverse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.visualize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;visualize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.Transition" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Transition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.RewardMatchPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RewardMatchPolicy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RewardMatchPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_OCCURRENCE" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;FIRST_OCCURRENCE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_SIBLING" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;FIRST_SIBLING
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;FunctionalAlgorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" FunctionalAlgorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm.run" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;FunctionalLitAgent
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" FunctionalLitAgent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent.rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent.rollout_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rollout_async
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.llm_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;llm_rollout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.prompt_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prompt_rollout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.ModelConfig" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ModelConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.LightningSpanExporter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LightningSpanExporter
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LightningSpanExporter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.LightningSpanExporter.export" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;export
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.LightningSpanExporter.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;shutdown
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.LightningOpenTelemetry" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LightningOpenTelemetry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.AddReturnTokenIds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AddReturnTokenIds
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AddReturnTokenIds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.AddReturnTokenIds.async_pre_call_hook" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;async_pre_call_hook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.store.base.UNSET" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;UNSET
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.store.utils.propagate_status" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;propagate_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.tracer.agentops.LightningSpanProcessor" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LightningSpanProcessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LightningSpanProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.tracer.agentops.LightningSpanProcessor.on_end" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;on_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.tracer.agentops.LightningSpanProcessor.spans" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;spans
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deprecated-apis" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecated APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deprecated APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AgentLightningServer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AgentLightningServer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.get_completed_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_completed_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.poll_completed_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll_completed_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.queue_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;queue_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.retrieve_completed_rollouts" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;retrieve_completed_rollouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.run_forever" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run_forever
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.start" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.stop" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.update_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ServerDataStore
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ServerDataStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.add_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.get_latest_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.get_next_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_next_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.get_processing_tasks" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_processing_tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.get_resources_by_id" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_resources_by_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.requeue_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;requeue_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.retrieve_completed_rollouts" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;retrieve_completed_rollouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.retrieve_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;retrieve_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.store_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;store_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.update_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AgentLightningClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AgentLightningClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.get_latest_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.get_latest_resources_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_resources_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.get_resources_by_id" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_resources_by_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.get_resources_by_id_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_resources_by_id_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.poll_next_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll_next_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.poll_next_task_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll_next_task_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.post_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;post_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.post_rollout_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;post_rollout_async
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.DevTaskLoader" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DevTaskLoader
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DevTaskLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.DevTaskLoader.rollouts" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;rollouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.DevTaskLoader.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.DevTaskLoader.poll_next_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll_next_task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.TaskInput" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;TaskInput
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.TaskIfAny" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TaskIfAny
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TaskIfAny">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.TaskIfAny.is_available" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_available
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.RolloutRawResultLegacy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;RolloutRawResultLegacy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.RolloutLegacy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RolloutLegacy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#agentlightning.adapter.messages.OpenAIMessages" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;OpenAIMessages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TraceTree
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TraceTree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.agent_name" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;agent_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.find_llm_calls" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;find_llm_calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.from_spans" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_spans
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.is_reward_span" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_reward_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.match_rewards" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;match_rewards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.maybe_reward_dict" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;maybe_reward_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.names_tuple" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;names_tuple
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.repair_hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;repair_hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.span_to_triplet" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;span_to_triplet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.to_trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_trajectory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.traverse" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;traverse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.TraceTree.visualize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;visualize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.Transition" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Transition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.RewardMatchPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RewardMatchPolicy
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" RewardMatchPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_OCCURRENCE" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;FIRST_OCCURRENCE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_SIBLING" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;FIRST_SIBLING
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;FunctionalAlgorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" FunctionalAlgorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm.run" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;FunctionalLitAgent
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" FunctionalLitAgent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent.rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.FunctionalLitAgent.rollout_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rollout_async
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.llm_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;llm_rollout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.litagent.decorator.prompt_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prompt_rollout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.ModelConfig" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ModelConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.LightningSpanExporter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LightningSpanExporter
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LightningSpanExporter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.LightningSpanExporter.export" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;export
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.LightningSpanExporter.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;shutdown
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.LightningOpenTelemetry" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LightningOpenTelemetry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.AddReturnTokenIds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AddReturnTokenIds
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AddReturnTokenIds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.llm_proxy.AddReturnTokenIds.async_pre_call_hook" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;async_pre_call_hook
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.store.base.UNSET" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;UNSET
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.store.utils.propagate_status" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;propagate_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agentlightning.tracer.agentops.LightningSpanProcessor" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LightningSpanProcessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LightningSpanProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.tracer.agentops.LightningSpanProcessor.on_end" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;on_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.tracer.agentops.LightningSpanProcessor.spans" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;spans
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deprecated-apis" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecated APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deprecated APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AgentLightningServer
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AgentLightningServer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.get_completed_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_completed_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.poll_completed_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll_completed_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.queue_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;queue_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.retrieve_completed_rollouts" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;retrieve_completed_rollouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.run_forever" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;run_forever
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.start" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.stop" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.AgentLightningServer.update_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ServerDataStore
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ServerDataStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.add_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.get_latest_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.get_next_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_next_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.get_processing_tasks" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_processing_tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.get_resources_by_id" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_resources_by_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.requeue_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;requeue_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.retrieve_completed_rollouts" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;retrieve_completed_rollouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.retrieve_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;retrieve_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.store_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;store_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.server.ServerDataStore.update_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;update_resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AgentLightningClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AgentLightningClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.get_latest_resources" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.get_latest_resources_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_latest_resources_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.get_resources_by_id" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_resources_by_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.get_resources_by_id_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_resources_by_id_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.poll_next_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll_next_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.poll_next_task_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll_next_task_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.post_rollout" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;post_rollout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.AgentLightningClient.post_rollout_async" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;post_rollout_async
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.DevTaskLoader" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DevTaskLoader
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" DevTaskLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.DevTaskLoader.rollouts" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;rollouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.DevTaskLoader.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.client.DevTaskLoader.poll_next_task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll_next_task
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.Task" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.TaskInput" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;TaskInput
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.TaskIfAny" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;TaskIfAny
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" TaskIfAny">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentlightning.TaskIfAny.is_available" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_available
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.RolloutRawResultLegacy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;RolloutRawResultLegacy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentlightning.RolloutLegacy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RolloutLegacy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <div id="version-warning" class="version-warning" style="display: none;">
    ⚠️ You are viewing development documentation. For stable documentation, please visit
    <a href="https://microsoft.github.io/agent-lightning/stable/">https://microsoft.github.io/agent-lightning/stable/</a>
  </div>
  
                  <!-- Copied and modified from https://github.com/squidfunk/mkdocs-material/blob/master/src/templates/partials/content.html -->

<!-- Tags -->



<!-- Actions -->

  
  


<!--
  Hack: check whether the content contains a h1 headline. If it doesn't, the
  page title (or respectively site name) is used as the main headline.
-->


<!-- Source file information -->







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 19, 2025 15:08:10 UTC"><span class="timeago" datetime="2025-10-19T15:08:10+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 19, 2025 15:08:10 UTC">2025-10-19</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 19, 2025 15:08:10 UTC"><span class="timeago" datetime="2025-10-19T15:08:10+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 19, 2025 15:08:10 UTC">2025-10-19</span>
  </span>

    
    
      
  
  <span class="md-source-file__fact">
    <span class="md-icon" title="Contributors">
      
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"/></svg>
      
    </span>
    <nav>
      
        <a href="mailto:yuge.zhang@microsoft.com">Yuge Zhang</a>
    </nav>
  </span>

    
    
  </aside>


<!-- Page content -->
<h1 id="internal-api-references">Internal API References<a class="headerlink" href="#internal-api-references" title="Permanent link">&para;</a></h1>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>The following APIs should be used with extra caution because they are very likely to change in the future.</p>
</div>


<div class="doc doc-object doc-class">



<h3 id="agentlightning.adapter.messages.OpenAIMessages" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.adapter.messages.OpenAIMessages</code>


<a href="#agentlightning.adapter.messages.OpenAIMessages" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>


        <p>OpenAI-style chat messages with optional tool definitions.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.messages.OpenAIMessages.messages">messages</span></code></b>
              (<code><span title="typing.List">List</span>[<span title="openai.types.chat.ChatCompletionMessageParam">ChatCompletionMessageParam</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Ordered chat messages that describe the conversation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.messages.OpenAIMessages.tools">tools</span></code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="openai.types.chat.ChatCompletionFunctionToolParam">ChatCompletionFunctionToolParam</span>]]</code>)
          –
          <div class="doc-md-description">
            <p>Tool specifications available to the assistant, if any.</p>
          </div>
        </li>
    </ul>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.adapter.triplet.TraceTree" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.adapter.triplet.TraceTree</code>


<a href="#agentlightning.adapter.triplet.TraceTree" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Tree representation of a trace span and its descendants.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.triplet.TraceTree.id">id</span></code></b>
          –
          <div class="doc-md-description">
            <p>Unique identifier for the span node.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.triplet.TraceTree.span">span</span></code></b>
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.Span" href="../types/#agentlightning.Span"><code>Span</code></a> backing this node.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.triplet.TraceTree.children">children</span></code></b>
          –
          <div class="doc-md-description">
            <p>Child nodes connected to the current span.</p>
          </div>
        </li>
    </ul>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.agent_name" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">agent_name</span><span class="p">()</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.agent_name" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the agent name associated with the span, if any.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
          –
          <div class="doc-md-description">
            <p>Agent name extracted from known attributes, otherwise <code>None</code>.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.find_llm_calls" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">find_llm_calls</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">llm_call_match</span><span class="p">,</span> <span class="n">agent_match</span><span class="p">,</span> <span class="n">within_matching_subtree</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">within_reward</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">within_llm_call</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">existing_llm_call_response_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.find_llm_calls" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Find LLM call spans matching the supplied filters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>llm_call_match</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Regular expression used to match span names that qualify as LLM calls.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>agent_match</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Optional regular expression that must match the enclosing agent span name.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>within_matching_subtree</code></b>
              (<code><span title="str">str</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Marker propagated through recursive calls to record matching agents.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>within_reward</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>When <code>True</code>, suppresses LLM matches under reward spans.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>within_llm_call</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>When <code>True</code>, prevents duplicate matches for nested LLM calls.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>existing_llm_call_response_ids</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="set">set</span>[<span title="str">str</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Known response identifiers used to deduplicate spans.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[&#39;TraceTree&#39;, <span title="str">str</span>]]</code>
          –
          <div class="doc-md-description">
            <p>A list of tuples pairing the matching node with the agent subtree label that triggered the</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[&#39;TraceTree&#39;, <span title="str">str</span>]]</code>
          –
          <div class="doc-md-description">
            <p>match.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.from_spans" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">from_spans</span><span class="p">(</span><span class="n">spans</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#agentlightning.adapter.triplet.TraceTree.from_spans" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Construct a tree from a flat list of spans.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>spans</code></b>
              (<code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Span (agentlightning.types.Span)" href="../types/#agentlightning.Span">Span</a>]</code>)
          –
          <div class="doc-md-description">
            <p>Spans that collectively form a single trace segment.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>&#39;TraceTree&#39;</code>
          –
          <div class="doc-md-description">
            <p>A <a class="autorefs autorefs-internal" title="            agentlightning.adapter.triplet.TraceTree" href="#agentlightning.adapter.triplet.TraceTree"><code>TraceTree</code></a> rooted at either the</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code>&#39;TraceTree&#39;</code>
          –
          <div class="doc-md-description">
            <p>discovered root span or a synthetic root when multiple roots are present.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If the span list is empty or no root span can be inferred.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.is_reward_span" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">is_reward_span</span><span class="p">()</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.is_reward_span" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return whether the span explicitly encodes a reward.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="bool">bool</span></code>
          –
          <div class="doc-md-description">
            <p><code>True</code> when the span payload describes a reward, otherwise <code>False</code>.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.match_rewards" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">match_rewards</span><span class="p">(</span><span class="n">reward_match</span><span class="p">,</span> <span class="n">llm_calls</span><span class="p">)</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.match_rewards" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Assign rewards to previously matched LLM calls.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>reward_match</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Strategy identifier from
<a class="autorefs autorefs-internal" title="            agentlightning.adapter.triplet.RewardMatchPolicy" href="#agentlightning.adapter.triplet.RewardMatchPolicy"><code>RewardMatchPolicy</code></a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>llm_calls</code></b>
              (<code><span title="typing.List">List</span>[&#39;TraceTree&#39;]</code>)
          –
          <div class="doc-md-description">
            <p>Trace nodes representing LLM call spans.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Optional">Optional</span>[<span title="float">float</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Mapping from span identifier to reward value or <code>None</code> when no reward is available.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.maybe_reward_dict" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">maybe_reward_dict</span><span class="p">()</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.maybe_reward_dict" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return a reward payload if the span encodes one.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
          –
          <div class="doc-md-description">
            <p>Dictionary containing reward metadata, or an empty dictionary when no reward is found.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.names_tuple" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">names_tuple</span><span class="p">()</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.names_tuple" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the span name alongside nested child names.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="str">str</span></code>
          –
          <div class="doc-md-description">
            <p>A tuple of the current span name and a list of tuples for each child containing the</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.List">List</span>[<span title="typing.Any">Any</span>]</code>
          –
          <div class="doc-md-description">
            <p>child name and its descendants.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.repair_hierarchy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">repair_hierarchy</span><span class="p">()</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.repair_hierarchy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Repair missing parent-child relationships introduced by mixed tracing systems.</p>
<p>Some agent frameworks emit spans via multiple subsystems, which can cause LLM completion
spans to float directly under the root span instead of being nested under the correct agent.
The method re-parents those spans to the closest ancestor that fully envelopes the child in
time.</p>
<p>If we don't, when we want to select the LLM completion span with agent as filter.
We will never get the correct span underneath.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.span_to_triplet" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">span_to_triplet</span><span class="p">(</span><span class="n">span</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.span_to_triplet" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Convert a span to a triplet.</p>
<p>Subclass can override this method to add more fields to the triplet,
such as chat messages and tool calls.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.to_json" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">to_json</span><span class="p">()</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.to_json" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Convert the tree node into a JSON-serialisable structure.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.to_trajectory" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">to_trajectory</span><span class="p">(</span><span class="n">llm_call_match</span><span class="o">=</span><span class="s1">&#39;openai</span><span class="se">\\</span><span class="s1">.chat</span><span class="se">\\</span><span class="s1">.completion&#39;</span><span class="p">,</span> <span class="n">agent_match</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude_llm_call_in_reward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dedup_llm_call</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reward_match</span><span class="o">=</span><span class="n">RewardMatchPolicy</span><span class="o">.</span><span class="n">FIRST_OCCURRENCE</span><span class="p">,</span> <span class="n">final_reward</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_skip_empty_token_spans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.to_trajectory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Convert the trace tree into a trajectory of <a class="autorefs autorefs-internal" title="            agentlightning.Triplet" href="../types/#agentlightning.Triplet"><code>Triplet</code></a> items.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>llm_call_match</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;openai\\.chat\\.completion&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Regular expression for LLM call span names.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>agent_match</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional regular expression for agent span names.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>exclude_llm_call_in_reward</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>When <code>True</code>, prevents searching for rewards under the LLM
call subtree.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dedup_llm_call</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>When <code>True</code>, deduplicates spans using the LLM response identifier.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>reward_match</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.adapter.triplet.RewardMatchPolicy" href="#agentlightning.adapter.triplet.RewardMatchPolicy">RewardMatchPolicy</a></code>, default:
                  <code><a class="autorefs autorefs-internal" title="            FIRST_OCCURRENCE = 'first_occurrence'

  
      class-attribute
      instance-attribute
   (agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_OCCURRENCE)" href="#agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_OCCURRENCE">FIRST_OCCURRENCE</a></code>
)
          –
          <div class="doc-md-description">
            <p>Reward matching policy used to associate reward spans with LLM calls.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>final_reward</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional reward appended to the final transition when provided.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Triplet (agentlightning.types.Triplet)" href="../types/#agentlightning.Triplet">Triplet</a>]</code>
          –
          <div class="doc-md-description">
            <p>A list of <a class="autorefs autorefs-internal" title="            agentlightning.Triplet" href="../types/#agentlightning.Triplet"><code>Triplet</code></a> objects ordered by call sequence.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.traverse" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">traverse</span><span class="p">()</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.traverse" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Traverse the tree depth first and return every node.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.adapter.triplet.TraceTree.visualize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">visualize</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">interested_span_match</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.adapter.triplet.TraceTree.visualize" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Render the trace tree with Graphviz for debugging purposes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>filename</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Base filename for the generated <code>.png</code> diagram.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>interested_span_match</code></b>
              (<code><span title="str">str</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional regular expression used to keep only matching spans
(and their ancestors) in the output.</p>
          </div>
        </li>
    </ul>
        <div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method requires the optional <code>graphviz</code> dependency to be available in the runtime
environment.</p>
</div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.adapter.triplet.Transition" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.adapter.triplet.Transition</code>


<a href="#agentlightning.adapter.triplet.Transition" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>A single transition within a reinforcement learning trajectory.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.triplet.Transition.state">state</span></code></b>
              (<code><span title="typing.List">List</span>[<span title="int">int</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Token identifiers describing the model input state.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.triplet.Transition.action">action</span></code></b>
              (<code><span title="typing.List">List</span>[<span title="int">int</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Token identifiers representing the model output.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.triplet.Transition.response_id">response_id</span></code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Identifier of the LLM response used to deduplicate spans.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.triplet.Transition.agent_name">agent_name</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Human-readable agent name captured from the trace.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.adapter.triplet.Transition.reward">reward</span></code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Scalar reward associated with the transition, if available.</p>
          </div>
        </li>
    </ul>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.adapter.triplet.RewardMatchPolicy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.adapter.triplet.RewardMatchPolicy</code>


<a href="#agentlightning.adapter.triplet.RewardMatchPolicy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Strategies for matching rewards to LLM call spans.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each reward span must expose a payload shaped like <code>{"type": "reward", "value": &lt;float&gt;|None}</code>
as described in <code>reward.py</code>.</p>
</div>











  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_OCCURRENCE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">FIRST_OCCURRENCE</span> <span class="o">=</span> <span class="s1">&#39;first_occurrence&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_OCCURRENCE" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Use the first reward encountered in chronological order after the current LLM call match.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_SIBLING" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">FIRST_SIBLING</span> <span class="o">=</span> <span class="s1">&#39;first_sibling&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.adapter.triplet.RewardMatchPolicy.FIRST_SIBLING" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Use the first sibling in the current trace subtree as the reward unless another LLM call match is found.</p>

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.algorithm.decorator.FunctionalAlgorithm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.algorithm.decorator.FunctionalAlgorithm</code>


<a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            agentlightning.Algorithm (agentlightning.algorithm.base.Algorithm)" href="../algorithm/#agentlightning.Algorithm">Algorithm</a></code>, <code><span title="typing.Generic">Generic</span>[<span title="agentlightning.algorithm.decorator.AF">AF</span>]</code></p>


        <p>An algorithm wrapper built from a callable implementation.</p>
<p>Functional algorithms let you provide an ordinary function instead of
subclassing <a class="autorefs autorefs-internal" title="            agentlightning.Algorithm" href="../algorithm/#agentlightning.Algorithm"><code>Algorithm</code></a>. The wrapper inspects
the callable signature to supply optional dependencies
such as the store, adapter, and LLM proxy.</p>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.algorithm.decorator.FunctionalAlgorithm.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">algorithm_func</span><span class="p">)</span></code>

<a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__init__</span><span class="p">(</span><span class="n">algorithm_func</span><span class="p">:</span> <span class="n">AlgorithmFuncSyncLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__init__</span><span class="p">(</span><span class="n">algorithm_func</span><span class="p">:</span> <span class="n">AlgorithmFuncAsyncLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>          </div>


    <div class="doc doc-contents ">

        <p>Wrap a function that implements algorithm behaviour.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>algorithm_func</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="agentlightning.algorithm.decorator.AlgorithmFuncSyncLike">AlgorithmFuncSyncLike</span>, <span title="agentlightning.algorithm.decorator.AlgorithmFuncAsyncLike">AlgorithmFuncAsyncLike</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Sync or async callable implementing the algorithm
contract. Arguments are detected automatically based on the
function signature.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.algorithm.decorator.FunctionalAlgorithm.run" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.algorithm.decorator.FunctionalAlgorithm.run" class="headerlink" title="Permanent link">&para;</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">train_dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">val_dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">train_dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">val_dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</code></pre></div>          </div>


    <div class="doc doc-contents ">

        <p>Execute the wrapped function with injected dependencies.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>train_dataset</code></b>
              (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Dataset (agentlightning.types.Dataset)" href="../types/#agentlightning.Dataset">Dataset</a>[<span title="typing.Any">Any</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional training dataset passed through when the
callable declares a <code>train_dataset</code> parameter.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>val_dataset</code></b>
              (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Dataset (agentlightning.types.Dataset)" href="../types/#agentlightning.Dataset">Dataset</a>[<span title="typing.Any">Any</span>]]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional validation dataset passed through when the
callable declares a <code>val_dataset</code> parameter.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Union">Union</span>[None, <span title="typing.Awaitable">Awaitable</span>[None]]</code>
          –
          <div class="doc-md-description">
            <p>None for sync callables or an awaitable when the callable is async.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="TypeError">TypeError</span></code>
            –
          <div class="doc-md-description">
            <p>If a dataset is provided but the function signature does
not accept the corresponding argument.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.litagent.decorator.FunctionalLitAgent" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.litagent.decorator.FunctionalLitAgent</code>


<a href="#agentlightning.litagent.decorator.FunctionalLitAgent" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            agentlightning.LitAgent (agentlightning.litagent.litagent.LitAgent)" href="../agent/#agentlightning.LitAgent">LitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>]</code></p>


        <p>Adapter that turns plain rollout functions into <a class="autorefs autorefs-internal" title="            agentlightning.LitAgent" href="../agent/#agentlightning.LitAgent"><code>LitAgent</code></a> instances.</p>
<p>The helper inspects the wrapped function to determine which resources to
inject, allowing both synchronous and asynchronous callables to participate
in the training loop without writing a dedicated subclass.</p>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.litagent.decorator.FunctionalLitAgent.__call__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#agentlightning.litagent.decorator.FunctionalLitAgent.__call__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Make the agent instance callable, preserving the original function behavior.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.litagent.decorator.FunctionalLitAgent.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">rollout_func</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">strip_proxy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#agentlightning.litagent.decorator.FunctionalLitAgent.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize the wrapper around a rollout function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rollout_func</code></b>
              (<code><span title="agentlightning.litagent.decorator.FunctionalLitAgentFunc">FunctionalLitAgentFunc</span>[<span title="agentlightning.litagent.decorator.T">T</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Callable that implements the rollout. It may be synchronous
or asynchronous and can optionally receive a
<a class="autorefs autorefs-internal" title="            agentlightning.Rollout" href="../types/#agentlightning.Rollout"><code>Rollout</code></a> alongside resources such as
<code>llm</code> or <code>prompt_template</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>strip_proxy</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>When <code>True</code>, convert
<a class="autorefs autorefs-internal" title="            agentlightning.ProxyLLM" href="../types/#agentlightning.ProxyLLM"><code>ProxyLLM</code></a> inputs into
<a class="autorefs autorefs-internal" title="            agentlightning.LLM" href="../types/#agentlightning.LLM"><code>LLM</code></a> instances before calling the
rollout function. Defaults to <code>True</code>.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.litagent.decorator.FunctionalLitAgent.rollout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">rollout</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">resources</span><span class="p">,</span> <span class="n">rollout</span><span class="p">)</span></code>

<a href="#agentlightning.litagent.decorator.FunctionalLitAgent.rollout" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Execute a synchronous rollout using the wrapped function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>task</code></b>
              (<code><span title="agentlightning.litagent.decorator.T">T</span></code>)
          –
          <div class="doc-md-description">
            <p>Task input data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>resources</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.NamedResources = Dict[str, ResourceUnion]

  
      module-attribute
   (agentlightning.types.NamedResources)" href="../types/#agentlightning.NamedResources">NamedResources</a></code>)
          –
          <div class="doc-md-description">
            <p>Mapping of named resources available to the agent.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rollout</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.Rollout (agentlightning.types.Rollout)" href="../types/#agentlightning.Rollout">Rollout</a></code>)
          –
          <div class="doc-md-description">
            <p>Rollout metadata provided by the runtime.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            agentlightning.RolloutRawResult = Union[None, float, List[ReadableSpan], List[Span]]

  
      module-attribute
   (agentlightning.types.RolloutRawResult)" href="../types/#agentlightning.RolloutRawResult">RolloutRawResult</a></code>
          –
          <div class="doc-md-description">
            <p>Result produced by the wrapped rollout function.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="RuntimeError">RuntimeError</span></code>
            –
          <div class="doc-md-description">
            <p>If the wrapped function is asynchronous.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.litagent.decorator.FunctionalLitAgent.rollout_async" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">rollout_async</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">resources</span><span class="p">,</span> <span class="n">rollout</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.litagent.decorator.FunctionalLitAgent.rollout_async" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Execute an asynchronous rollout using the wrapped function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>task</code></b>
              (<code><span title="agentlightning.litagent.decorator.T">T</span></code>)
          –
          <div class="doc-md-description">
            <p>Task input data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>resources</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.NamedResources = Dict[str, ResourceUnion]

  
      module-attribute
   (agentlightning.types.NamedResources)" href="../types/#agentlightning.NamedResources">NamedResources</a></code>)
          –
          <div class="doc-md-description">
            <p>Mapping of named resources available to the agent.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>rollout</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.Rollout (agentlightning.types.Rollout)" href="../types/#agentlightning.Rollout">Rollout</a></code>)
          –
          <div class="doc-md-description">
            <p>Rollout metadata provided by the runtime.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            agentlightning.RolloutRawResult = Union[None, float, List[ReadableSpan], List[Span]]

  
      module-attribute
   (agentlightning.types.RolloutRawResult)" href="../types/#agentlightning.RolloutRawResult">RolloutRawResult</a></code>
          –
          <div class="doc-md-description">
            <p>Result produced by the wrapped rollout coroutine.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="RuntimeError">RuntimeError</span></code>
            –
          <div class="doc-md-description">
            <p>If the wrapped function is synchronous.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agentlightning.litagent.decorator.llm_rollout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">agentlightning</span><span class="o">.</span><span class="n">litagent</span><span class="o">.</span><span class="n">decorator</span><span class="o">.</span><span class="n">llm_rollout</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">strip_proxy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#agentlightning.litagent.decorator.llm_rollout" class="headerlink" title="Permanent link">&para;</a></h3>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">llm_rollout</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">func</span><span class="p">:</span> <span class="n">LlmRolloutFunc</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FunctionalLitAgent</span><span class="p">[</span><span class="n">T</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">llm_rollout</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="o">*</span><span class="p">,</span> <span class="n">strip_proxy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">LlmRolloutFunc</span><span class="p">[</span><span class="n">T</span><span class="p">]],</span> <span class="n">FunctionalLitAgent</span><span class="p">[</span><span class="n">T</span><span class="p">]]</span>
</code></pre></div>          </div>


    <div class="doc doc-contents first">

        <p>Create a <a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent"><code>FunctionalLitAgent</code></a> for LLM-based rollouts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>func</code></b>
              (<code><span title="agentlightning.litagent.decorator.LlmRolloutFunc">LlmRolloutFunc</span>[<span title="agentlightning.litagent.decorator.T">T</span>] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Callable defining the agent's behaviour. Supported signatures include:</p>
<ul>
<li><code>(task, llm) -&gt; result</code></li>
<li><code>(task, llm, rollout) -&gt; result</code></li>
<li><code>async (task, llm) -&gt; result</code></li>
<li><code>async (task, llm, rollout) -&gt; result</code></li>
</ul>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>strip_proxy</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>When <code>True</code>, convert proxy resources into concrete
<a class="autorefs autorefs-internal" title="            agentlightning.LLM" href="../types/#agentlightning.LLM"><code>LLM</code></a> instances before calling the
function. Defaults to <code>True</code>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent">FunctionalLitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>] | <span title="typing.Callable">Callable</span>[[<span title="agentlightning.litagent.decorator.LlmRolloutFunc">LlmRolloutFunc</span>[<span title="agentlightning.litagent.decorator.T">T</span>]], <a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent">FunctionalLitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>]]</code>
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent"><code>FunctionalLitAgent</code></a> that</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent">FunctionalLitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>] | <span title="typing.Callable">Callable</span>[[<span title="agentlightning.litagent.decorator.LlmRolloutFunc">LlmRolloutFunc</span>[<span title="agentlightning.litagent.decorator.T">T</span>]], <a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent">FunctionalLitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>]]</code>
          –
          <div class="doc-md-description">
            <p>wraps the supplied function.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@llm_rollout</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_agent</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">llm</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="n">llm</span><span class="o">.</span><span class="n">endpoint</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nd">@llm_rollout</span><span class="p">(</span><span class="n">strip_proxy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_agent_no_strip</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">llm</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">return</span> <span class="n">llm</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">result</span> <span class="o">=</span> <span class="n">my_agent</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">llm</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">result</span> <span class="o">=</span> <span class="n">my_agent</span><span class="o">.</span><span class="n">rollout</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">resources</span><span class="p">,</span> <span class="n">rollout</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agentlightning.litagent.decorator.prompt_rollout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">agentlightning</span><span class="o">.</span><span class="n">litagent</span><span class="o">.</span><span class="n">decorator</span><span class="o">.</span><span class="n">prompt_rollout</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#agentlightning.litagent.decorator.prompt_rollout" class="headerlink" title="Permanent link">&para;</a></h3>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prompt_rollout</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">func</span><span class="p">:</span> <span class="n">PromptRolloutFunc</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FunctionalLitAgent</span><span class="p">[</span><span class="n">T</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prompt_rollout</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">Callable</span><span class="p">[[</span><span class="n">PromptRolloutFunc</span><span class="p">[</span><span class="n">T</span><span class="p">]],</span> <span class="n">FunctionalLitAgent</span><span class="p">[</span><span class="n">T</span><span class="p">]]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</code></pre></div>          </div>


    <div class="doc doc-contents first">

        <p>Create a <a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent"><code>FunctionalLitAgent</code></a> for prompt-based rollouts.</p>
<p>This decorator is designed for agents that work with tunable prompt templates. It enables
a workflow where algorithms manage and optimize the prompt template, while agents consume
the template to perform rollouts. This is particularly useful for prompt optimization scenarios.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>func</code></b>
              (<code><span title="agentlightning.litagent.decorator.PromptRolloutFunc">PromptRolloutFunc</span>[<span title="agentlightning.litagent.decorator.T">T</span>] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Callable defining the agent's behavior. Supported signatures include:</p>
<ul>
<li><code>(task, prompt_template) -&gt; result</code></li>
<li><code>(task, prompt_template, rollout) -&gt; result</code></li>
<li><code>async (task, prompt_template) -&gt; result</code></li>
<li><code>async (task, prompt_template, rollout) -&gt; result</code></li>
</ul>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent">FunctionalLitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>] | <span title="typing.Callable">Callable</span>[[<span title="agentlightning.litagent.decorator.PromptRolloutFunc">PromptRolloutFunc</span>[<span title="agentlightning.litagent.decorator.T">T</span>]], <a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent">FunctionalLitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>]]</code>
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent"><code>FunctionalLitAgent</code></a> that</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent">FunctionalLitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>] | <span title="typing.Callable">Callable</span>[[<span title="agentlightning.litagent.decorator.PromptRolloutFunc">PromptRolloutFunc</span>[<span title="agentlightning.litagent.decorator.T">T</span>]], <a class="autorefs autorefs-internal" title="            agentlightning.litagent.decorator.FunctionalLitAgent" href="#agentlightning.litagent.decorator.FunctionalLitAgent">FunctionalLitAgent</a>[<span title="agentlightning.litagent.decorator.T">T</span>]]</code>
          –
          <div class="doc-md-description">
            <p>wraps the supplied function.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@prompt_rollout</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_agent</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">prompt_template</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">messages</span> <span class="o">=</span> <span class="n">prompt_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="k">return</span> <span class="n">messages</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">result</span> <span class="o">=</span> <span class="n">my_agent</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">prompt_template</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">result</span> <span class="o">=</span> <span class="n">my_agent</span><span class="o">.</span><span class="n">rollout</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">resources</span><span class="p">,</span> <span class="n">rollout</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.llm_proxy.ModelConfig" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.llm_proxy.ModelConfig</code>


<a href="#agentlightning.llm_proxy.ModelConfig" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>


        <p>LiteLLM model registration entry.</p>
<p>This mirrors the items in LiteLLM's <code>model_list</code> section.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.llm_proxy.ModelConfig.model_name">model_name</span></code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Logical model name exposed by the proxy.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.llm_proxy.ModelConfig.litellm_params">litellm_params</span></code></b>
              (<code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Parameters passed to LiteLLM for this model
(e.g., backend model id, api_base, additional options).</p>
          </div>
        </li>
    </ul>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.llm_proxy.LightningSpanExporter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.llm_proxy.LightningSpanExporter</code>


<a href="#agentlightning.llm_proxy.LightningSpanExporter" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="opentelemetry.sdk.trace.export.SpanExporter">SpanExporter</span></code></p>


        <p>Buffered OTEL span exporter with subtree flushing and training-store sink.</p>
<p>Design:</p>
<ul>
<li>Spans are buffered until a root span's entire subtree is available.</li>
<li>A private event loop on a daemon thread runs async flush logic.</li>
<li>Rollout/attempt/sequence metadata is reconstructed by merging headers
  from any span within a subtree.</li>
</ul>
<p>Thread-safety:</p>
<ul>
<li>Buffer access is protected by a re-entrant lock.</li>
<li>Export is synchronous to the caller yet schedules an async flush on the
  internal loop, then waits for completion.</li>
</ul>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.llm_proxy.LightningSpanExporter.export" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">export</span><span class="p">(</span><span class="n">spans</span><span class="p">)</span></code>

<a href="#agentlightning.llm_proxy.LightningSpanExporter.export" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Export spans via buffered subtree flush.</p>
<p>Appends spans to the internal buffer, then triggers an async flush on the
private event loop. Blocks until that flush completes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>spans</code></b>
              (<code><span title="typing.Sequence">Sequence</span>[<span title="opentelemetry.sdk.trace.ReadableSpan">ReadableSpan</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Sequence of spans to export.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>SpanExportResult</code></b> (              <code><span title="opentelemetry.sdk.trace.export.SpanExportResult">SpanExportResult</span></code>
)          –
          <div class="doc-md-description">
            <p>SUCCESS on flush success, else FAILURE.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.llm_proxy.LightningSpanExporter.shutdown" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">shutdown</span><span class="p">()</span></code>

<a href="#agentlightning.llm_proxy.LightningSpanExporter.shutdown" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Shut down the exporter event loop.</p>
<p>Safe to call at process exit.</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.llm_proxy.LightningOpenTelemetry" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.llm_proxy.LightningOpenTelemetry</code>


<a href="#agentlightning.llm_proxy.LightningOpenTelemetry" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="litellm.integrations.opentelemetry.OpenTelemetry">OpenTelemetry</span></code></p>


        <p>OpenTelemetry integration that exports spans to the Lightning store.</p>
<p>Responsibilities:</p>
<ul>
<li>Ensures each request is annotated with a per-attempt sequence id so spans
  are ordered deterministically even with clock skew across nodes.</li>
<li>Uses <a class="autorefs autorefs-internal" title="            agentlightning.llm_proxy.LightningSpanExporter" href="#agentlightning.llm_proxy.LightningSpanExporter"><code>LightningSpanExporter</code></a> to persist spans for analytics and training.</li>
</ul>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.llm_proxy.AddReturnTokenIds" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.llm_proxy.AddReturnTokenIds</code>


<a href="#agentlightning.llm_proxy.AddReturnTokenIds" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="litellm.integrations.custom_logger.CustomLogger">CustomLogger</span></code></p>


        <p>LiteLLM logger hook to request token ids from vLLM.</p>
<p>This mutates the outgoing request payload to include <code>return_token_ids=True</code>
for backends that support token id return (e.g., vLLM).</p>


<details class="see-also" open>
  <summary>See also</summary>
  <p><a href="https://github.com/vllm-project/vllm/pull/22587">vLLM PR #22587</a></p>
</details>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.llm_proxy.AddReturnTokenIds.async_pre_call_hook" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">async_pre_call_hook</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.llm_proxy.AddReturnTokenIds.async_pre_call_hook" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Async pre-call hook to adjust request payload.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>args</code></b>
              (<code><span title="typing.Any">Any</span></code>, default:
                  <code>()</code>
)
          –
          <div class="doc-md-description">
            <p>Positional args from LiteLLM.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>kwargs</code></b>
              (<code><span title="typing.Any">Any</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Keyword args from LiteLLM.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="Exception">Exception</span>, <span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
          –
          <div class="doc-md-description">
            <p>Either an updated payload dict or an Exception to short-circuit.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="agentlightning.store.base.UNSET" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">agentlightning</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">UNSET</span> <span class="o">=</span> <span class="n">_UnsetType</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#agentlightning.store.base.UNSET" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="agentlightning.store.utils.propagate_status" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">agentlightning</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">propagate_status</span><span class="p">(</span><span class="n">update_rollout_status</span><span class="p">,</span> <span class="n">attempt</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.store.utils.propagate_status" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Propagate the status of an attempt to the rollout.</p>
<p>The rollout should be made sure in a state to be outdated.
Requeue the rollout if it should be retried.</p>
<p>This operation is completely unlocked. The caller is responsible for locking the store.</p>


    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.tracer.agentops.LightningSpanProcessor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.tracer.agentops.LightningSpanProcessor</code>


<a href="#agentlightning.tracer.agentops.LightningSpanProcessor" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="agentops.sdk.processors.SpanProcessor">SpanProcessor</span></code></p>


        <p>Span processor that subclasses OpenTelemetry's <code>SpanProcessor</code> and adds support to dump traces
to a <a class="autorefs autorefs-internal" title="            agentlightning.LightningStore" href="../store/#agentlightning.LightningStore"><code>LightningStore</code></a>.</p>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.tracer.agentops.LightningSpanProcessor.on_end" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">on_end</span><span class="p">(</span><span class="n">span</span><span class="p">)</span></code>

<a href="#agentlightning.tracer.agentops.LightningSpanProcessor.on_end" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Process a span when it ends.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>span</code></b>
              (<code><span title="opentelemetry.sdk.trace.ReadableSpan">ReadableSpan</span></code>)
          –
          <div class="doc-md-description">
            <p>The span that has ended.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.tracer.agentops.LightningSpanProcessor.spans" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">spans</span><span class="p">()</span></code>

<a href="#agentlightning.tracer.agentops.LightningSpanProcessor.spans" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the list of spans collected by this processor.
This is useful for debugging and testing purposes.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.List">List</span>[<span title="opentelemetry.sdk.trace.ReadableSpan">ReadableSpan</span>]</code>
          –
          <div class="doc-md-description">
            <p>List of ReadableSpan objects collected during tracing.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div><h2 id="deprecated-apis">Deprecated APIs<a class="headerlink" href="#deprecated-apis" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="agentlightning.server.AgentLightningServer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.server.AgentLightningServer</code>


<a href="#agentlightning.server.AgentLightningServer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>High-level controller for the legacy Agent Lightning FastAPI server.</p>
<p>The controller orchestrates server start-up, task queueing, resource updates,
and retrieval of client rollouts. It is primarily used by existing systems that
still rely on the HTTP-based workflow.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p><a class="autorefs autorefs-internal" title="            agentlightning.server.AgentLightningServer" href="#agentlightning.server.AgentLightningServer"><code>AgentLightningServer</code></a> is part of
the legacy client/server stack. Prefer the store-based runtime for new
integrations.</p>
</div>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">task_timeout_seconds</span><span class="o">=</span><span class="mf">300.0</span><span class="p">)</span></code>

<a href="#agentlightning.server.AgentLightningServer.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize the controller.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>host</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;127.0.0.1&#39;</code>
)
          –
          <div class="doc-md-description">
            <p>Hostname or IP address to bind the HTTP server to.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>port</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>8000</code>
)
          –
          <div class="doc-md-description">
            <p>TCP port exposed by the server.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>task_timeout_seconds</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>300.0</code>
)
          –
          <div class="doc-md-description">
            <p>Seconds before a claimed task is considered stale and
re-queued.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.get_completed_rollout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_completed_rollout</span><span class="p">(</span><span class="n">rollout_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.AgentLightningServer.get_completed_rollout" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Retrieve a specific completed rollout by identifier.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.poll_completed_rollout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">poll_completed_rollout</span><span class="p">(</span><span class="n">rollout_id</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.AgentLightningServer.poll_completed_rollout" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Poll for a completed rollout until it becomes available or a timeout expires.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rollout_id</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Identifier of the rollout to wait for.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>timeout</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Maximum number of seconds to wait. <code>None</code> waits indefinitely.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.RolloutLegacy (agentlightning.types.RolloutLegacy)" href="#agentlightning.RolloutLegacy">RolloutLegacy</a>]</code>
          –
          <div class="doc-md-description">
            <p>Retrieved rollout, or <code>None</code> when the timeout is reached without success.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.queue_task" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">queue_task</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resources_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.AgentLightningServer.queue_task" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a task to the queue for a client to process.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.retrieve_completed_rollouts" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">retrieve_completed_rollouts</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.AgentLightningServer.retrieve_completed_rollouts" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return every completed rollout and clear the internal buffer.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.run_forever" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">run_forever</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.AgentLightningServer.run_forever" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Run the server indefinitely until <code>stop()</code> is invoked.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.start" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">start</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.AgentLightningServer.start" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Start the FastAPI server in the background.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.stop" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">stop</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.AgentLightningServer.stop" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Stop the FastAPI server and wait for a graceful shutdown.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.AgentLightningServer.update_resources" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">update_resources</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.AgentLightningServer.update_resources" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Publish a new resource bundle and return its generated identifier.</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.server.ServerDataStore" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.server.ServerDataStore</code>


<a href="#agentlightning.server.ServerDataStore" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Async-safe container for in-memory server state.</p>
<p>The store tracks queued tasks, claimed tasks, uploaded rollouts, and the
currently published resources. All interactions are guarded by asyncio locks
so that the FastAPI handlers can safely run in parallel.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p><a class="autorefs autorefs-internal" title="            agentlightning.server.ServerDataStore" href="#agentlightning.server.ServerDataStore"><code>ServerDataStore</code></a> is part of
the legacy client/server stack. Use <a class="autorefs autorefs-internal" title="            agentlightning.LightningStore" href="../store/#agentlightning.LightningStore"><code>LightningStore</code></a> instead.</p>
</div>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.add_task" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">add_task</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resources_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.add_task" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Enqueue a new task and return the generated rollout identifier.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>sample</code></b>
              (<code><span title="typing.Any">Any</span></code>)
          –
          <div class="doc-md-description">
            <p>Payload that describes the task input.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mode</code></b>
              (<code><span title="typing.Literal">Literal</span>[&#39;train&#39;, &#39;val&#39;, &#39;test&#39;] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Phase in which the sample should be executed (<code>"train"</code>, <code>"val"</code>, or
<code>"test"</code>).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>resources_id</code></b>
              (<code><span title="str">str</span> | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Identifier of a resource bundle that the executor should
load before running the task.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>metadata</code></b>
              (<code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Optional metadata forwarded to the executor.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="str">str</span></code>
          –
          <div class="doc-md-description">
            <p>Unique rollout identifier assigned to the task.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.get_latest_resources" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_latest_resources</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.get_latest_resources" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the most recent resource bundle, if one exists.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.get_next_task" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_next_task</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.get_next_task" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Retrieve the next task from the queue without blocking.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Task (agentlightning.types.Task)" href="#agentlightning.Task">Task</a>]</code>
          –
          <div class="doc-md-description">
            <p>Next <a class="autorefs autorefs-internal" title="            agentlightning.Task" href="#agentlightning.Task"><code>Task</code></a> ready to execute, or <code>None</code></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Task (agentlightning.types.Task)" href="#agentlightning.Task">Task</a>]</code>
          –
          <div class="doc-md-description">
            <p>when the queue is empty.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.get_processing_tasks" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_processing_tasks</span><span class="p">()</span></code>

<a href="#agentlightning.server.ServerDataStore.get_processing_tasks" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return a copy of currently processing tasks for timeout checking.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.get_resources_by_id" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_resources_by_id</span><span class="p">(</span><span class="n">resources_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.get_resources_by_id" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Retrieve a specific resource bundle by identifier.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>resources_id</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Identifier that was previously published to the store.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p>Matching <a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate" href="../types/#agentlightning.ResourcesUpdate"><code>ResourcesUpdate</code></a></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p>instance, or <code>None</code> when the identifier is unknown.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.requeue_task" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">requeue_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.requeue_task" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Requeue a task that timed out while being processed.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.retrieve_completed_rollouts" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">retrieve_completed_rollouts</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.retrieve_completed_rollouts" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return all completed rollouts and clear the internal buffer.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.retrieve_rollout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">retrieve_rollout</span><span class="p">(</span><span class="n">rollout_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.retrieve_rollout" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Retrieve and remove a stored rollout by identifier.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rollout_id</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Identifier of the rollout to fetch.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.RolloutLegacy (agentlightning.types.RolloutLegacy)" href="#agentlightning.RolloutLegacy">RolloutLegacy</a>]</code>
          –
          <div class="doc-md-description">
            <p>Stored <a class="autorefs autorefs-internal" title="            agentlightning.RolloutLegacy" href="#agentlightning.RolloutLegacy"><code>RolloutLegacy</code></a>, or <code>None</code></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.RolloutLegacy (agentlightning.types.RolloutLegacy)" href="#agentlightning.RolloutLegacy">RolloutLegacy</a>]</code>
          –
          <div class="doc-md-description">
            <p>when the identifier is unknown.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.store_rollout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">store_rollout</span><span class="p">(</span><span class="n">rollout</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.store_rollout" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Persist a completed rollout for later inspection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rollout</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.RolloutLegacy (agentlightning.types.RolloutLegacy)" href="#agentlightning.RolloutLegacy">RolloutLegacy</a></code>)
          –
          <div class="doc-md-description">
            <p>Rollout returned by a client.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.server.ServerDataStore.update_resources" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">update_resources</span><span class="p">(</span><span class="n">update</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.server.ServerDataStore.update_resources" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Persist a new resource bundle and mark it as the latest version.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>update</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a></code>)
          –
          <div class="doc-md-description">
            <p>Resource payload received from a client.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.client.AgentLightningClient" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.client.AgentLightningClient</code>


<a href="#agentlightning.client.AgentLightningClient" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Client wrapper for the legacy version-aware Agent Lightning server.</p>
<p>The client exposes synchronous and asynchronous helpers for polling tasks,
retrieving resource bundles, and submitting rollouts. It also maintains a
simple in-memory cache keyed by the server-provided resource identifier to
avoid redundant network requests.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p><a class="autorefs autorefs-internal" title="            agentlightning.client.AgentLightningClient" href="#agentlightning.client.AgentLightningClient"><code>AgentLightningClient</code></a> is part of
the legacy client/server stack. New code should rely on the store-based APIs
implemented in <code>agentlightning.store</code>.</p>
</div>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.client.AgentLightningClient.endpoint">endpoint</span></code></b>
          –
          <div class="doc-md-description">
            <p>Base URL of the Agent Lightning server.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.client.AgentLightningClient.poll_interval">poll_interval</span></code></b>
          –
          <div class="doc-md-description">
            <p>Delay in seconds between polling attempts when no task is
available.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.client.AgentLightningClient.timeout">timeout</span></code></b>
          –
          <div class="doc-md-description">
            <p>Timeout in seconds applied to HTTP requests.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="agentlightning.client.AgentLightningClient.task_count">task_count</span></code></b>
          –
          <div class="doc-md-description">
            <p>Number of tasks claimed during the lifetime of this client.</p>
          </div>
        </li>
    </ul>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span></code>

<a href="#agentlightning.client.AgentLightningClient.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize the client.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>endpoint</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Root URL of the Agent Lightning server.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>poll_interval</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>5.0</code>
)
          –
          <div class="doc-md-description">
            <p>Seconds to wait between polling attempts.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>timeout</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>10.0</code>
)
          –
          <div class="doc-md-description">
            <p>Seconds before a request to the server is considered timed out.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.get_latest_resources" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_latest_resources</span><span class="p">()</span></code>

<a href="#agentlightning.client.AgentLightningClient.get_latest_resources" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Fetch the most recent resource bundle advertised by the server.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate" href="../types/#agentlightning.ResourcesUpdate"><code>ResourcesUpdate</code></a> for the</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p>newest version, or <code>None</code> when unavailable.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.get_latest_resources_async" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_latest_resources_async</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.client.AgentLightningClient.get_latest_resources_async" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Fetch the most recent resource bundle advertised by the server.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate" href="../types/#agentlightning.ResourcesUpdate"><code>ResourcesUpdate</code></a> for the</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p>newest version, or <code>None</code> when unavailable.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.get_resources_by_id" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_resources_by_id</span><span class="p">(</span><span class="n">resource_id</span><span class="p">)</span></code>

<a href="#agentlightning.client.AgentLightningClient.get_resources_by_id" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Fetch a specific resource bundle by identifier.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>resource_id</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Identifier sourced from the task metadata.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p>Cached or freshly downloaded</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate" href="../types/#agentlightning.ResourcesUpdate"><code>ResourcesUpdate</code></a>, or</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p><code>None</code> when the server returns an error.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.get_resources_by_id_async" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_resources_by_id_async</span><span class="p">(</span><span class="n">resource_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.client.AgentLightningClient.get_resources_by_id_async" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Fetch a specific resource bundle by identifier.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>resource_id</code></b>
              (<code><span title="str">str</span></code>)
          –
          <div class="doc-md-description">
            <p>Identifier sourced from the task metadata.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p>Cached or freshly downloaded</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p><a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate" href="../types/#agentlightning.ResourcesUpdate"><code>ResourcesUpdate</code></a>, or</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>
          –
          <div class="doc-md-description">
            <p><code>None</code> when the server returns an error.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.poll_next_task" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">poll_next_task</span><span class="p">()</span></code>

<a href="#agentlightning.client.AgentLightningClient.poll_next_task" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Poll the server synchronously until a task becomes available.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Task (agentlightning.types.Task)" href="#agentlightning.Task">Task</a>]</code>
          –
          <div class="doc-md-description">
            <p>The next <a class="autorefs autorefs-internal" title="            agentlightning.Task" href="#agentlightning.Task"><code>Task</code></a> available for execution, or</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Task (agentlightning.types.Task)" href="#agentlightning.Task">Task</a>]</code>
          –
          <div class="doc-md-description">
            <p><code>None</code> if polling fails.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.poll_next_task_async" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">poll_next_task_async</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.client.AgentLightningClient.poll_next_task_async" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Poll the server asynchronously until a task becomes available.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Task (agentlightning.types.Task)" href="#agentlightning.Task">Task</a>]</code>
          –
          <div class="doc-md-description">
            <p>The next <a class="autorefs autorefs-internal" title="            agentlightning.Task" href="#agentlightning.Task"><code>Task</code></a> exposed by the server,</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Task (agentlightning.types.Task)" href="#agentlightning.Task">Task</a>]</code>
          –
          <div class="doc-md-description">
            <p>or <code>None</code> if polling fails.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.post_rollout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">post_rollout</span><span class="p">(</span><span class="n">rollout</span><span class="p">)</span></code>

<a href="#agentlightning.client.AgentLightningClient.post_rollout" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Submit a completed rollout back to the server.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rollout</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.RolloutLegacy (agentlightning.types.RolloutLegacy)" href="#agentlightning.RolloutLegacy">RolloutLegacy</a></code>)
          –
          <div class="doc-md-description">
            <p>Legacy rollout payload produced by the executor.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Parsed JSON response returned by the server, or <code>None</code> when the request fails.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.AgentLightningClient.post_rollout_async" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">post_rollout_async</span><span class="p">(</span><span class="n">rollout</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#agentlightning.client.AgentLightningClient.post_rollout_async" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Submit a completed rollout back to the server.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>rollout</code></b>
              (<code><a class="autorefs autorefs-internal" title="            agentlightning.RolloutLegacy (agentlightning.types.RolloutLegacy)" href="#agentlightning.RolloutLegacy">RolloutLegacy</a></code>)
          –
          <div class="doc-md-description">
            <p>Legacy rollout payload produced by the executor.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Parsed JSON response returned by the server, or <code>None</code> when the request fails.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.client.DevTaskLoader" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.client.DevTaskLoader</code>


<a href="#agentlightning.client.DevTaskLoader" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            agentlightning.client.AgentLightningClient" href="#agentlightning.client.AgentLightningClient">AgentLightningClient</a></code></p>


        <p>In-memory task loader used for development and integration tests.</p>
<p>The loader mimics the behavior of the legacy HTTP server by storing tasks and
resources locally. Polling methods simply iterate over the provided collection,
allowing rapid iteration without provisioning any external infrastructure.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p><a class="autorefs autorefs-internal" title="            agentlightning.client.DevTaskLoader" href="#agentlightning.client.DevTaskLoader"><code>DevTaskLoader</code></a> is a compatibility shim.
Prefer <a class="autorefs autorefs-internal" title="            dev(agent, train_dataset=None, *, val_dataset=None)" href="../trainer/#agentlightning.Trainer.dev"><code>Trainer.dev</code></a> for new code.</p>
</div>











  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.client.DevTaskLoader.rollouts" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">rollouts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#agentlightning.client.DevTaskLoader.rollouts" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the rollouts posted back to the loader during development runs.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.DevTaskLoader.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">tasks</span><span class="p">,</span> <span class="n">resources</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#agentlightning.client.DevTaskLoader.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize the loader with predefined tasks and resources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>tasks</code></b>
              (<code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="            agentlightning.TaskInput = Any

  
      module-attribute
   (agentlightning.types.TaskInput)" href="#agentlightning.TaskInput">TaskInput</a>], <span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Task (agentlightning.types.Task)" href="#agentlightning.Task">Task</a>]]</code>)
          –
          <div class="doc-md-description">
            <p>Sequence of task inputs or preconstructed tasks that will be served in
order.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>resources</code></b>
              (<code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="            agentlightning.NamedResources = Dict[str, ResourceUnion]

  
      module-attribute
   (agentlightning.types.NamedResources)" href="../types/#agentlightning.NamedResources">NamedResources</a>, <a class="autorefs autorefs-internal" title="            agentlightning.ResourcesUpdate (agentlightning.types.ResourcesUpdate)" href="../types/#agentlightning.ResourcesUpdate">ResourcesUpdate</a>]</code>)
          –
          <div class="doc-md-description">
            <p>Static resources returned for any <code>resources_id</code> query.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
              (<code><span title="typing.Any">Any</span></code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments forwarded to the parent client.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            –
          <div class="doc-md-description">
            <p>If no tasks are provided or both <a class="autorefs autorefs-internal" title="            agentlightning.Task" href="#agentlightning.Task"><code>Task</code></a>
and <a class="autorefs autorefs-internal" title="            agentlightning.TaskInput = Any

  
      module-attribute
  " href="#agentlightning.TaskInput"><code>TaskInput</code></a> instances are mixed.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="agentlightning.client.DevTaskLoader.poll_next_task" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">poll_next_task</span><span class="p">()</span></code>

<a href="#agentlightning.client.DevTaskLoader.poll_next_task" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the next task from the local queue.</p>
<p>If <a class="autorefs autorefs-internal" title="            agentlightning.TaskInput = Any

  
      module-attribute
  " href="#agentlightning.TaskInput"><code>TaskInput</code></a> instances were provided,
they are converted into <a class="autorefs autorefs-internal" title="            agentlightning.Task" href="#agentlightning.Task"><code>Task</code></a> objects on the
fly. Otherwise, the preconstructed tasks are returned in sequence.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            agentlightning.Task (agentlightning.types.Task)" href="#agentlightning.Task">Task</a>]</code>
          –
          <div class="doc-md-description">
            <p>Next task to execute.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.Task" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.Task</code>


<a href="#agentlightning.Task" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Rollout request served to client agents.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The legacy HTTP client/server stack still uses this model. Prefer
<a class="autorefs autorefs-internal" title="            agentlightning.LightningStore" href="../store/#agentlightning.LightningStore"><code>LightningStore</code></a> APIs for new workflows.</p>
</div>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="agentlightning.TaskInput" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">agentlightning</span><span class="o">.</span><span class="n">TaskInput</span> <span class="o">=</span> <span class="n">Any</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#agentlightning.TaskInput" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Task input type. Accepts arbitrary payloads.</p>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.TaskIfAny" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.TaskIfAny</code>


<a href="#agentlightning.TaskIfAny" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>A task or indication that no task is available.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>Use <a class="autorefs autorefs-internal" title="            agentlightning.LightningStore" href="../store/#agentlightning.LightningStore"><code>LightningStore</code></a> APIs for new workflows.</p>
</div>











  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="agentlightning.TaskIfAny.is_available" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">is_available</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#agentlightning.TaskIfAny.is_available" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Indication that a task is available.</p>

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="agentlightning.RolloutRawResultLegacy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">agentlightning</span><span class="o">.</span><span class="n">RolloutRawResultLegacy</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Triplet</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">List</span><span class="p">[</span><span class="n">ReadableSpan</span><span class="p">],</span> <span class="n">RolloutLegacy</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#agentlightning.RolloutRawResultLegacy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Legacy rollout result type.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>Use <a class="autorefs autorefs-internal" title="            agentlightning.RolloutRawResult = Union[None, float, List[ReadableSpan], List[Span]]

  
      module-attribute
  " href="../types/#agentlightning.RolloutRawResult"><code>RolloutRawResult</code></a> instead.</p>
</div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="agentlightning.RolloutLegacy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>agentlightning.RolloutLegacy</code>


<a href="#agentlightning.RolloutLegacy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Legacy reporting payload exchanged with the deprecated HTTP server.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>Use <a class="autorefs autorefs-internal" title="            agentlightning.Rollout" href="../types/#agentlightning.Rollout"><code>Rollout</code></a> instead.</p>
</div>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<!-- Was this page helpful? -->




<!-- Comment system -->

                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="https://unpkg.com/chart.js@4.5.1/dist/chart.umd.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../javascripts/charts.js"></script>
      
        <script src="../../javascripts/move-source-file.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
    
  <script>
    // Show warning banner if not viewing stable documentation
    document.addEventListener("DOMContentLoaded", function() {
      const currentURL = window.location.href;
      const warningDiv = document.getElementById("version-warning");

      // Check if we're on the stable docs or the redirect page
      if (currentURL.includes('agent-lightning/latest/')) {
        // Show warning for explicitly latest docs
        warningDiv.style.display = "block";
      }
    });
  </script>

  </body>
</html>